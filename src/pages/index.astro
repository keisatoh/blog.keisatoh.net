---
import Footer from '../components/Footer.astro';
import { getExcerpt } from '../utils';
import type { MarkdownInstance } from 'astro';
import type { Frontmatter } from '../types';

const excerpt = (post: MarkdownInstance<Frontmatter>) => {
  const html = post.compiledContent();
  return getExcerpt(html, 80);
};
---

<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>blog.keisatoh.net</title>
  </head>
  <body>
    <div class="container mx-auto max-w-4xl px-6">
      <header class="py-10">
        <h1 class="text-xl font-medium sm:text-3xl">
          <a href="/">blog.keisatoh.net</a>
        </h1>
      </header>
      <main class="py-10">
        {
          posts.map((post) => (
            <article class="[&:nth-child(n+2)]:mt-10">
              <time datetime={post.frontmatter.date}>
                {new Date(post.frontmatter.date).toLocaleDateString('ja-JP', {
                  year: 'numeric',
                  month: 'short',
                  day: 'numeric',
                })}
              </time>
              <h2 class="mt-2 text-xl font-normal sm:text-3xl">
                <a href={post.url}>{post.frontmatter.title}</a>
              </h2>
              <p class="mt-3 text-sm font-normal text-slate-600 sm:text-lg">
                {post.frontmatter.dek || excerpt(post)}
              </p>
            </article>
          ))
        }
      </main>
      <Footer />
    </div>
  </body>
</html>
